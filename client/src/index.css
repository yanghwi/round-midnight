@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== 디자인 토큰 (스프라이트/박스셰도우용) ===== */
/* 컴포넌트 색상은 tailwind.config.js가 source of truth */
:root {
  /* Backgrounds */
  --bg-dark: #0d0221;
  --bg-mid: #1a0533;
  --ui-bg: #101028;

  /* Primary Accents */
  --pink: #e84393;
  --purple: #6c5ce7;
  --gold: #fdcb6e;

  /* Secondary */
  --lavender: #a29bfe;
  --orange: #e67e22;
  --green: #2ecc71;
  --green-dark: #1e6b35;
  --red: #e74c3c;
  --blue: #3498db;
  --cyan: #00cec9;

  /* UI Chrome */
  --ui-border: #f8f8f8;
  --ui-shadow: rgba(0, 0, 0, 0.5);

  /* Skin / NPC */
  --skin-light: #ffeaa7;
  --skin-mid: #f6e58d;
  --wood: #8e6630;
  --trunk: #5D4037;

  /* Metal (Starman 계열) */
  --metal-light: #dfe6e9;
  --metal-mid: #a4b0be;
  --metal-dark: #636e72;

  /* Pixel grid */
  --pixel: 4px;

  /* Typography */
  --font-title: 'Press Start 2P', 'Noto Sans KR', sans-serif;
  --font-body: 'Silkscreen', 'Noto Sans KR', sans-serif;
}

/* 기본 스타일 */
body {
  @apply bg-midnight-800 text-slate-100 font-sans m-0 p-0;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* 모바일 터치 최적화 */
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
  user-select: none;
  /* 세로 화면 고정 */
  overflow-x: hidden;
  min-height: 100dvh;
}

#root {
  min-height: 100dvh;
  display: flex;
  flex-direction: column;
}

/* 스크롤바 숨기기 (모바일 게임 UI) */
::-webkit-scrollbar {
  display: none;
}

/* 안전 영역 (아이폰 노치) */
@supports (padding: env(safe-area-inset-top)) {
  body {
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

/* ===== EarthBound UI 윈도우 ===== */
@layer components {
  .eb-window {
    background: var(--ui-bg);
    border: 3px solid var(--ui-border);
    border-radius: 6px;
    padding: 12px 16px;
    box-shadow: var(--pixel) var(--pixel) 0 var(--ui-shadow);
  }
}

/* ===== 스캔라인 오버레이 ===== */
.scanlines {
  position: absolute;
  inset: 0;
  z-index: 50;
  pointer-events: none;
  background: repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 3px,
    rgba(0, 0, 0, 0.08) 3px,
    rgba(0, 0, 0, 0.08) 4px
  );
}

/* ===== 로비 배경/타이틀 애니메이션 ===== */
.psychedelic-bg {
  position: absolute;
  inset: 0;
  background:
    repeating-conic-gradient(
      from 0deg at 50% 120%,
      #0d0221 0deg 10deg,
      #1a0533 10deg 20deg,
      #2d1b69 20deg 30deg,
      #1a0533 30deg 40deg
    );
  animation: rotateBg 20s linear infinite;
  opacity: 0.6;
}

@keyframes rotateBg {
  to { transform: rotate(360deg); }
}

.checker-overlay {
  position: absolute;
  inset: -100%;
  background:
    repeating-conic-gradient(#e84393 0% 25%, transparent 0% 50%) 0 0 / 24px 24px;
  opacity: 0.04;
  animation: scrollCheck 8s linear infinite;
}

@keyframes scrollCheck {
  to { transform: translate(24px, 24px); }
}

.lobby-title {
  text-shadow:
    4px 4px 0 #e84393,
    -2px -2px 0 #6c5ce7,
    0 0 20px rgba(232, 67, 147, 0.5),
    0 0 40px rgba(108, 92, 231, 0.3);
  animation: titleGlow 3s ease-in-out infinite alternate;
}

@keyframes titleGlow {
  0% {
    text-shadow:
      4px 4px 0 #e84393,
      -2px -2px 0 #6c5ce7,
      0 0 20px rgba(232, 67, 147, 0.5),
      0 0 40px rgba(108, 92, 231, 0.3);
  }
  100% {
    text-shadow:
      4px 4px 0 #e84393,
      -2px -2px 0 #6c5ce7,
      0 0 30px rgba(232, 67, 147, 0.8),
      0 0 60px rgba(108, 92, 231, 0.5),
      0 0 80px rgba(253, 203, 110, 0.2);
  }
}

.lobby-subtitle {
  text-shadow: 2px 2px 0 rgba(0,0,0,0.5);
  animation: subtitlePulse 2s ease-in-out infinite alternate;
}

@keyframes subtitlePulse {
  0% { opacity: 0.7; }
  100% { opacity: 1; }
}

.lobby-star {
  position: absolute;
  background: #fff;
  width: 2px;
  height: 2px;
  image-rendering: pixelated;
  animation: twinkle 1.5s ease-in-out infinite alternate;
}

.lobby-star:nth-child(odd) { animation-delay: 0.3s; }
.lobby-star:nth-child(3n) { animation-delay: 0.7s; }
.lobby-star:nth-child(5n) { background: #fdcb6e; width: 3px; height: 3px; }
.lobby-star:nth-child(7n) { background: #e84393; }

@keyframes twinkle {
  0% { opacity: 0.3; }
  100% { opacity: 1; }
}

/* ===== 가로 모드 차단 ===== */
#landscape-block {
  display: none;
}

@media (orientation: landscape) and (max-height: 500px) {
  #landscape-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    position: fixed;
    inset: 0;
    z-index: 9999;
    background: #0f0f1a;
    color: #f8fafc;
    font-family: 'Noto Sans KR', sans-serif;
    font-size: 16px;
    text-align: center;
  }

  #landscape-block p:first-child {
    font-size: 48px;
  }

  #root {
    display: none;
  }
}
